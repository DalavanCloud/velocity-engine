<HTML><HEAD><TITLE>VTL Reference Guide</TITLE></HEAD><BODY alink="#023264" bgcolor="#ffffff" leftmargin="4" link="#023264" marginheight="4" marginwidth="4" text="#000000" topmargin="4" vlink="#023264"><TABLE border="0" cellpadding="0" cellspacing="0" width="100%"><TR><TD align="left" valign="top"><A href="http://jakarta.apache.org/index.html"><IMG border="0" hspace="0" src="resources/jakarta-logo.gif" vspace="0"></A></TD><TD align="left" bgcolor="#ffffff" valign="top" width="100%"><IMG align="right" alt="" border="0" hspace="0" src="resources/header.gif" vspace="0"></TD></TR><TR><TD><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="5"></TD></TR><TR><TD background="resources/line.gif" colspan="2" height="2" width="100%"><IMG alt="" border="0" height="2" hspace="0" src="resources/line.gif" vspace="0" width="1"></TD></TR></TABLE><TABLE border="0" cellpadding="0" cellspacing="0" width="100%"><TR><TD valign="top" width="1%"></TD><TD nowrap="1" valign="top" width="14%"><BR>

<P>About</P>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="index.html">Overview</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="getting-started.html">Getting Started</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="install.html">Install</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="design.html">Design</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="contributors.html">Contributors</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="code-standards.html">Coding Standards</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="license.html">License</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="todo.html">TODO</A></LI></FONT>
<P>Guides</P>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="user-guide.html">User's Guide</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="developer-guide.html">Developer's Guide</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="vtl-reference-guide.html">VTL Reference Guide</A></LI></FONT>
<P>Tools</P>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="anakia.html">Anakia</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="texen.html">Texen</A></LI></FONT>
    <FONT face="arial,helvetica,sanserif" size="-1"><LI><A href="migration.html">Migration To Velocity</A></LI></FONT>
</TD><TD align="left" valign="top" width="*"><TABLE border="0" cellpadding="3" cellspacing="0"><TR><TD><BR>

 



<DIV align="right"><TABLE border="0" cellpadding="0" cellspacing="0" width="98%"><TR><TD bgcolor="#023264" width="100%"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="5"><B>About this Guide</B></FONT></TD></TR><TR><TD><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR></TABLE><TABLE border="0" cellpadding="0" cellspacing="0" width="98%"><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif">

<P align="justify">
    This guide is the definitive but imcomplete reference for
    the Velocity Template Language (VTL). For more information,
    please refer to the Velocity User Guide.
</P> 

</FONT></TD></TR></TABLE></DIV><BR>

<DIV align="right"><TABLE border="0" cellpadding="0" cellspacing="0" width="98%"><TR><TD bgcolor="#023264" width="100%"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="5"><B>References</B></FONT></TD></TR><TR><TD><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR></TABLE><TABLE border="0" cellpadding="0" cellspacing="0" width="98%"><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif">

<P align="justify"></P>

    <BLOCKQUOTE><UL>

    <LI>Variables</LI>
    <P align="justify"></P>
    Notation:
    <P align="justify"></P>
    <B>$</B> [ <B>!</B> ][ <B>{</B> ][ <B>a..z</B>, <B>A..Z</B> ][ <B>a..z</B>, <B>A..Z</B>, <B>0..9</B>, <B>-</B>, <B>_</B> ][ <B>}</B> ]
    <P align="justify"></P>
    Examples:<BR>
    Normal notation: <VARIABLE><FONT face="courier, monospaced">$mud-Slinger_9</FONT></VARIABLE><BR>
    Silent notation: <VARIABLE><FONT face="courier, monospaced">$!mud-Slinger_9</FONT></VARIABLE><BR>
    Formal notation: <VARIABLE><FONT face="courier, monospaced">${mud-Slinger_9}</FONT></VARIABLE><BR>
    <P align="justify"></P>

    <LI>Properties</LI>
    <P align="justify"></P>
    Notation:
    <P align="justify"></P>
    <B>$</B> [ <B>{</B> ][ <B>a..z</B>, <B>A..Z</B> ][ <B>a..z</B>, <B>A..Z</B>, <B>0..9</B>, <B>-</B>, <B>_</B> ]*<B>.</B>[<B>a..z</B>, <B>A..Z</B> ][ <B>a..z</B>, <B>A-Z</B>, <B>0..9</B>, <B>-</B>, <B>_</B> ]* [ <B>}</B> ]
    <P align="justify"></P>
    Examples:
    <P align="justify"></P>
    Regular Notation: $customer.Address<BR>
    Formal Notation: ${purchase.Total}<BR>
    <P align="justify"></P>    

    <LI>Methods</LI>
    <P align="justify"></P>
    Notation:
    <P align="justify"></P>
    <B>$</B> [ <B>{</B> ][ <B>a..z</B>, <B>A..Z</B> ][ <B>a..z</B>, <B>A..Z</B>, <B>0..9</B>, <B>-</B>, <B>_</B> ]*<B>.</B>[ <B>a..z</B>, <B>A..Z</B> ][ <B>a..z</B>, <B>A..Z</B>, <B>0..9</B>, <B>-</B>, <B>_</B> ]*<B>(</B> [ opional parameter list... ] <B>)</B> [<B> } </B>]<BR>
    Examples:<BR>
    Regular Notation: $customer.getAddress()<BR>
    Formal Notation: ${purchase.getTotal()}<BR>
    Regular Notation with Parameter List: $page.setTitle( &quot;My Home Page&quot; )<BR>
    <P align="justify"></P>
    VTL Properties can be used as a shorthand notation for VTL Methods that take <VTL><FONT face="courier, monospaced">get</FONT></VTL> and <VTL><FONT face="courier, monospaced">set</FONT></VTL>. Either <VTL><FONT face="courier, monospaced">$object.getMethod()</FONT></VTL> or <VTL><FONT face="courier, monospaced">$object.setMethod()</FONT></VTL> can be abbreviated as <VTL><FONT face="courier, monospaced">$object.Method</FONT></VTL>. It is generally preferable to use a Property when available. The main difference between Properties and Methods is that you can specify a parameter list to a Method.
    <P align="justify"></P>

    </UL></BLOCKQUOTE>

</FONT></TD></TR></TABLE></DIV><BR>

<DIV align="right"><TABLE border="0" cellpadding="0" cellspacing="0" width="98%"><TR><TD bgcolor="#023264" width="100%"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="5"><B>Directives</B></FONT></TD></TR><TR><TD><IMG border="0" height="5" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR></TABLE><TABLE border="0" cellpadding="0" cellspacing="0" width="98%"><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif">

    <P align="justify"></P>
    <BLOCKQUOTE><UL>
    <LI><B>#set</B> - Establishes the value of a reference.</LI>
    <P align="justify"></P>
    Format:
    <P align="justify"></P>
    <B>#set( $</B>ref <B>=</B> [ <B>&quot;</B>, <B>'</B> ]arg[ <B>&quot;</B>, <B>'</B> ] )
    <P align="justify"></P>
    Usage:
    <BR>
    <VTL><FONT face="courier, monospaced">$ref</FONT></VTL> - The LHS of the assignment must be a variable reference or a property reference.<BR>
    <VTL><FONT face="courier, monospaced">arg</FONT></VTL> - The RHS of the assignment, <VTL><FONT face="courier, monospaced">arg</FONT></VTL> is parsed if enclosed in double quotes, and not parsed if enclosed in single quotes. Examples of possible types are demonstrated:
    <BR>
    <BLOCKQUOTE><UL>
        <LI>Variable reference: #set( $monkey = &quot;bill&quot; )</LI>
        <LI>String literal: #set( $monkey.Friend = &quot;monica&quot; )</LI>
        <LI>Property reference: #set( $monkey.Blame = $whitehouse.Leak )</LI>
        <LI>Method reference: #set( $monkey.Plan = $spindoctor.weave($web) )</LI>
        <LI>Number literal: #set( $monkey.Number = 123 )</LI>
        <LI>Object array: #set( $monkey.Say = [&quot;Not&quot;, $my, &quot;fault&quot;] )</LI>
    </UL></BLOCKQUOTE>
    The RHS can also be a simple arithmetic expression, such as:<BR>
        <BLOCKQUOTE><UL>
	    <LI>Addition: #set( $value = $foo + 1 )</LI>
	    <LI>Subtraction: #set( $value = $bar - 1 )</LI>
	    <LI>Multiplication: #set( $value = $foo * $bar )</LI>
	    <LI>Division: #set( $value = $foo / $bar )</LI>
	    <LI>Remainder: #set( $value = $foo % $bar )</LI>
	    </UL></BLOCKQUOTE>
    <P align="justify"></P>


    <LI><B>#if / #ifelse / #else</B> -  output conditional on truth of statements.</LI>
    <P align="justify"></P>
    Format:
    <P align="justify"></P>
    <B>#if(</B> [condition] <B>)</B> [output] [ <B>#elseif( </B>[condition] <B>)</B> [output] ]* [ <B>#else( </B>[condition] <B>)</B> [output] ] <B>#end</B> 
    <P align="justify"></P>
    Usage:
    <BR>
    <VTL><FONT face="courier, monospaced">condition</FONT></VTL> - If a boolean, considered true if it has a true false; if not a boolean, considered true if not null. Examples of conditions are listed below:<BR>
    <BLOCKQUOTE><UL>
           <LI>Equivalent Operator: #if( $foo == $bar )</LI>
	   <LI>Greater Than: #if( $foo &gt; 42 )</LI>
	   <LI>Less Than: #if( $foo &lt; 42 )</LI>
	   <LI>Greater Than or Equal To: #if( $foo &gt;= 42 )</LI>
	   <LI>Less Than or Equal To: #if( $foo &lt;= 42 )</LI>
	   <LI>Equals Number: #if( $foo = 42 )</LI>
	   <LI>Equals String: #if( $foo = &quot;bar&quot; )</LI>
    </UL></BLOCKQUOTE>	   
    <VTL><FONT face="courier, monospaced">output</FONT></VTL> - May contain VTL. 
    <P align="justify"></P>

    <LI><B>#foreach</B> - Loops through a list of objects.</LI>
    <P align="justify"></P>
    Format:
    <P align="justify"></P>
    <B>#foreach( $</B>ref1 <B>in $</B>ref2 <B>)</B> [ statement... ] <B>#end</B> 
    <P align="justify"></P>
    Usage:
    <BR>
    <VTL><FONT face="courier, monospaced">$ref1</FONT></VTL> - The first variable reference is the item.<BR>
    <VTL><FONT face="courier, monospaced">$ref2</FONT></VTL> - The second variable reference is the list that holds the items.<BR>
    <VTL><FONT face="courier, monospaced">statement</FONT></VTL> - What is done each time Velocity finds a valid item ($ref1) in the list ($ref2).<BR>
    Velocity provides an easy way to get the loop counter so that you can do something like the following:<BR>   

    <DIV align="center"><TABLE border="0" cellpadding="0" cellspacing="4"><TR><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR><TR><TD bgcolor="#023264" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#ffffff"><PRE> 
    &lt;table&gt; 
    #foreach( $customer in $customerList ) 
    &lt;tr&gt;&lt;td&gt; $velocityCounter &lt;/td&gt;&lt;td&gt; $customer.Name &lt;/td&gt;&lt;/tr&gt; 
    #end &lt;/table&gt; 
    </PRE></TD><TD bgcolor="#023264" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR><TR><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR></TABLE></DIV>
    <BR>

    The default name for the loop counter variable reference, which is specified in the velocity.properties file, is $velocityCount. By default the counter starts at 1, but this can be set to either 0 or 1 in the <FILENAME><I>velocity.properties</I></FILENAME> file. Here's what the loop counter properties section of the <FILENAME><I>velocity.properties</I></FILENAME> file appears:    

<P align="justify">    
    <DIV align="center"><TABLE border="0" cellpadding="0" cellspacing="4"><TR><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR><TR><TD bgcolor="#023264" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#ffffff"><PRE>
    # Default name of the loop counter
    # variable refernce.
      counter.name = velocityCount
    
    # Default starting value of the loop
    # counter variable reference.
    counter.initial.value = 1
    </PRE></TD><TD bgcolor="#023264" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR><TR><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR></TABLE></DIV>
</P>

    <LI><B>#include</B> - Renders local file(s) that are not parsed by Velocity.</LI>
    <P align="justify"></P>
    Format:
    <P align="justify"></P>
    <B>#include( </B>arg[, arg2, ... argn]<B> )</B> 
    <P align="justify"></P>
    <VTL><FONT face="courier, monospaced">arg</FONT></VTL> - Refers to a valid file under TEMPLATE_ROOT. Can be one of two types:
    <BR>
    <BLOCKQUOTE><UL>
          <LI>String: #include( &quot;disclaimer.txt&quot;, &quot;opinion.txt&quot; )</LI>
	  <LI>Variable: #include( $foo, $bar )</LI>
    </UL></BLOCKQUOTE>
    <P align="justify"></P>

    <LI><B>#parse</B> - Renders a local template that is parsed by Velocity.</LI>
    <P align="justify"></P>

    Format:
    <P align="justify"></P>
    <B>#parse( </B>arg<B> )</B>
    <P align="justify"></P>
    <VTL><FONT face="courier, monospaced">arg</FONT></VTL> - Refers to a template under TEMPLATE_ROOT. Can be one of two types:
    <BR>
    <BLOCKQUOTE><UL>
          <LI>String: #parse( &quot;lecorbusier.vm&quot; )</LI>
	  <LI>Variable: #parse( $foo )</LI>
    </UL></BLOCKQUOTE>
    <P align="justify"></P>
    Recursion permitted. See <VTL><FONT face="courier, monospaced">parse_directive.maxdepth</FONT></VTL> in <FILENAME><I>velocity.properties</I></FILENAME> 
    to change from parse depth. (The default parse depth is 10.)
    <P align="justify"></P>

    <LI><B>#stop</B> - Stops the template engine.</LI>
    <P align="justify"></P>
    Format:
    <P align="justify"></P>
    #stop
    <P align="justify"></P>
    Usage:
    <BR>
    Intended for debugging purposes.
    <P align="justify"></P>

    <LI><B>#macro</B> - Allows users to define a Velocimacro (VM), a repeated segment of a VTL template, as required.</LI>
    <P align="justify"></P>
    Format:
    <P align="justify"></P>   
    <B>#macro(</B> vmname $arg1[, $arg2, $arg3, ... $argn ] <B>)</B> [ VM VTL code... ] <B>#end</B>
    <P align="justify"></P>
    <VTL><FONT face="courier, monospaced">vmname</FONT></VTL> - Name used to call the VM (<VTL><FONT face="courier, monospaced">#vmname</FONT></VTL>)<BR>
    <VTL><FONT face="courier, monospaced">$arg1 $arg2 [ ... ]</FONT></VTL> - Arguments to the VM. There can be any number of argumentss, but the number used at invocation must match the number specified in the definition.<BR>
    <VTL><FONT face="courier, monospaced">[ VM VTL code... ]</FONT></VTL> - Any valid VTL code, anything you can put into a template, can be put into a VM.
   <P align="justify"></P>

   Once defined, the VM is used like any other VTL directive in a template.
   <P align="justify"></P>

   <DIV align="center"><TABLE border="0" cellpadding="0" cellspacing="4"><TR><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR><TR><TD bgcolor="#023264" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#ffffff"><PRE>
   #vmname( $arg1 $arg2 )
   </PRE></TD><TD bgcolor="#023264" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR><TR><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD><TD bgcolor="#023264" height="1" width="1"><IMG border="0" height="1" hspace="0" src="resources/void.gif" vspace="0" width="1"></TD></TR></TABLE></DIV>

   <P align="justify"></P>
   VMs can be defined in one of three places:
   <BR>
   Global library: VMs pre-packaged with Velocity; available from any template<BR>
   Local library: customized, user-defined, site-specific VMs; availabe from any template<BR>
   Inline: found in regular templates, only usable when <VTL><FONT face="courier, monospaced">velocimacro.permissions.allowInline=true</FONT></VTL> in <FILENAME><I>velocity.properties</I></FILENAME>.
   <P align="justify"></P>

</UL></BLOCKQUOTE>

</FONT></TD></TR></TABLE></DIV><BR>


</TD></TR></TABLE></TD></TR></TABLE><BR><TABLE border="0" cellpadding="0" cellspacing="0" width="100%"><TR><TD bgcolor="#023264"><IMG height="1" src="resources/resources.gif" width="1"></TD></TR><TR><TD align="center"><FONT color="#023264" face="arial,helvetica,sanserif" size="-1"><I>
              Copyright &copy; 2000 The Apache Software Foundation.
              All Rights Reserved.
            </I></FONT></TD></TR></TABLE></BODY></HTML>